---
title: Flake FHS
description: Flake FHS 框架的官方文档站点 - 通过标准化目录结构自动生成 flake outputs
template: splash
hero:
  tagline: 通过标准化的目录结构自动生成 Nix Flake outputs，简化 Nix 项目配置
  image:
    file: ../../../assets/logo.svg
  actions:
    - text: 快速开始
      link: /zh-cn/manual/
      icon: rocket
      variant: primary
    - text: 查看 GitHub
      link: https://github.com/luochen1990/flake-fhs
      icon: github
      variant: secondary
---

import { Card, CardGrid, LinkCard, Steps, Icon } from '@astrojs/starlight/components';

## 什么是 Flake FHS？

**Flake FHS** (Flake Filesystem Hierarchy Standard) 是一个 Nix Flake 框架，通过标准化的目录结构自动生成 flake outputs，旨在解决 Nix 项目配置中的常见痛点：**样板代码重复**、**结构差异巨大**以及**工具链集成难**。

你只需将文件放入约定的目录，框架会自动处理剩余的工作。

---

## 核心特性

<CardGrid stagger>
  <Card title="约定优于配置" icon="document">
    将文件系统的目录结构直接映射为 Flake Outputs，如 `pkgs/`, `modules/`, `hosts/` 等，目录结构即 API。
  </Card>
  <Card title="统一构建范式" icon="puzzle">
    无论是软件包、应用程序还是测试用例，均采用统一的 `package.nix` + `callPackage` 机制构建，共享依赖。
  </Card>
  <Card title="智能模块加载" icon="setting">
    自动递归发现 `modules/` 下的 NixOS 模块。实现模块的“声明即注册，启用即加载”。
  </Card>
  <Card title="渐进式采用" icon="random">
    支持混合模式。你可以仅让 Flake FHS 接管一部分输出，而将其他部分留给传统方式定义，实现平滑迁移。
  </Card>
</CardGrid>

---

## 快速导航

<CardGrid>
  <LinkCard title="最佳实践" description="了解如何高效使用 Flake FHS" href="/zh-cn/manual-best-practices/" />
  <LinkCard title="系统配置 (Hosts)" description="管理 NixOS 系统配置" href="/zh-cn/manual-hosts/" />
  <LinkCard title="软件包 (Packages)" description="构建和管理软件包" href="/zh-cn/manual-pkgs/" />
  <LinkCard title="开发环境 (Shells)" description="定义开发 Shell" href="/zh-cn/manual-shells/" />
</CardGrid>

---

## 5分钟快速上手

<Steps>

1.  **初始化项目**

    使用 Flake FHS 提供的标准模板快速开始：

    ```bash
    nix flake init --template github:luochen1990/flake-fhs#std
    ```

2.  **配置 flake.nix**

    确保你的 `flake.nix` 引入了 `flake-fhs`：

    ```nix
    {
      inputs = {
        nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";
        flake-fhs.url = "github:luochen1990/flake-fhs";
      };

      outputs = inputs@{ flake-fhs, ... }:
        flake-fhs.lib.mkFlake { inherit inputs; } {
          systems = [ "x86_64-linux" ];
        };
    }
    ```

3.  **添加内容**

    创建一个软件包 `pkgs/hello/package.nix`，无需注册，它会被自动发现：

    ```nix
    { stdenv, fetchurl }:
    stdenv.mkDerivation {
      name = "hello-2.10";
      src = fetchurl { /* ... */ };
    }
    ```

4.  **构建**

    ```bash
    nix build .#hello
    ```

</Steps>
