---
title: ä½¿ç”¨æ‰‹å†Œ
description: Flake FHS çš„å®Œæ•´ä½¿ç”¨æ‰‹å†Œï¼ŒåŒ…å«å¿«é€Ÿæ¦‚è§ˆã€è¯¦ç»†æŒ‡å—å’Œæœ€ä½³å®è·µ
---

import { LinkCard, CardGrid, Aside } from '@astrojs/starlight/components';

Flake FHS æ˜¯ä¸€ä¸ª Nix Flake æ¡†æ¶ï¼Œæ—¨åœ¨é€šè¿‡æ ‡å‡†åŒ–çš„ç›®å½•ç»“æ„è‡ªåŠ¨ç”Ÿæˆ flake outputsï¼Œå‡å°‘é…ç½®æ–‡ä»¶çš„ç»´æŠ¤æˆæœ¬ã€‚

## 1. å¿«é€Ÿæ¦‚è§ˆ

æ¡†æ¶çš„æ ¸å¿ƒæœºåˆ¶æ˜¯å°†æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•ç»“æ„ç›´æ¥æ˜ å°„ä¸º Nix flake outputsã€‚

**ç›®å½•æ˜ å°„è¡¨**

| ç›®å½• | ç”Ÿæˆ Output | å¯¹åº”çš„ Nix å‘½ä»¤ | è¯¦ç»†æ–‡æ¡£ |
| :--- | :--- | :--- | :--- |
| [`hosts`](#guide-hosts) | `nixosConfigurations.<name>` | `nixos-rebuild switch --flake .#<name>` | [ç³»ç»Ÿé…ç½® (hosts)](/zh-cn/manual-hosts) |
| [`modules`](#guide-modules) | `nixosModules.<name>` | - | [NixOS æ¨¡å— (modules)](/zh-cn/manual-modules) |
| [`pkgs`](#guide-pkgs) | `packages.<system>.<name>` | `nix build .#<name>` | [è½¯ä»¶åŒ… (pkgs)](/zh-cn/manual-pkgs) |
| [`apps`](#guide-apps) | `apps.<system>.<name>` | `nix run .#<name>` | [åº”ç”¨ç¨‹åº (apps)](/zh-cn/manual-apps) |
| [`checks`](#guide-checks) | `checks.<system>.<name>` | `nix flake check .#<name>` | [æµ‹è¯•ä¸æ£€æŸ¥ (checks)](/zh-cn/manual-checks) |
| [`shells`](#guide-shells) | `devShells.<system>.<name>` | `nix develop .#<name>` | [å¼€å‘ç¯å¢ƒ (shells)](/zh-cn/manual-shells) |
| [`lib`](#guide-lib) | `lib.<name>` | `nix eval .#lib.<name>` | [å‡½æ•°åº“ (lib)](/zh-cn/manual-lib) |
| [`templates`](#guide-templates) | `templates.<name>` | `nix flake init --template .#<name>` | [æ¨¡æ¿ (templates)](/zh-cn/manual-templates) |

## 2. è¯¦ç»†æŒ‡å—

<Aside type="tip" title="æ–°æ‰‹æç¤º">
ä½ **ä¸éœ€è¦**ä¸€æ¬¡æ€§è¯»å®Œæ‰€æœ‰æ–‡æ¡£ã€‚Flake outputs æ˜¯æŒ‰éœ€ç”Ÿæˆçš„ï¼Œåªæœ‰å½“ä½ åˆ›å»ºäº†å¯¹åº”çš„ç›®å½•æ—¶ï¼Œç›¸å…³åŠŸèƒ½æ‰ä¼šç”Ÿæ•ˆã€‚ä½ å¯ä»¥å…ˆä» `hosts` å¼€å§‹é…ç½®ä½ çš„ç³»ç»Ÿï¼Œæ ¹æ®éœ€è¦å†é€æ­¥æ¢ç´¢å…¶ä»–åŠŸèƒ½ã€‚
</Aside>

æœ¬æ‰‹å†ŒæŒ‰æ¨èå­¦ä¹ é¡ºåºæ’åˆ—ï¼š

### <span id="guide-hosts">ğŸ–¥ï¸ ç³»ç»Ÿé…ç½® (Hosts)</span>

å®šä¹‰å…·ä½“çš„æœºå™¨é…ç½®ï¼ˆEntrypointsï¼‰ã€‚

*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-hosts)](/zh-cn/manual-hosts)**
*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-modules)](/zh-cn/manual-modules)**
*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-pkgs)](/zh-cn/manual-pkgs)**
*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-apps)](/zh-cn/manual-apps)**
*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-checks)](/zh-cn/manual-checks)**
*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-shells)](/zh-cn/manual-shells)**
*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-lib)](/zh-cn/manual-lib)**
*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-templates)](/zh-cn/manual-templates)**
*   **ğŸ“– [é˜…è¯»è¯¦ç»†æ‰‹å†Œ (manual-config)](/zh-cn/manual-config)**
*   **æ ¸å¿ƒå†…å®¹**ï¼š
    *   `mkFlake` é€‰é¡¹è¯´æ˜ (`systems`, `nixpkgs.config` ç­‰)ã€‚
    *   ä»£ç æ ¼å¼åŒ–å·¥å…· (`nix fmt`) çš„è®¾ç½®ã€‚

## 3. æœ€ä½³å®è·µ

### é¡¹ç›®ç»„ç»‡

*   **éµå¾ªçº¦å®š**ï¼šå°½é‡ä½¿ç”¨æ¡†æ¶é»˜è®¤çš„ç›®å½•ç»“æ„ï¼Œå‡å°‘è‡ªå®šä¹‰é…ç½®ã€‚
*   **æ¨¡å—åŒ–**ï¼šå°†å¤æ‚çš„ç³»ç»Ÿé…ç½®æ‹†åˆ†ä¸ºå°çš„ã€å¯å¤ç”¨çš„æ¨¡å— (`modules/`)ã€‚
*   **åˆ©ç”¨å°è£…**ï¼šå¦‚æœä¸€ä¸ªåŒ…éœ€è¦å¤šä¸ªè¾…åŠ©æ–‡ä»¶ï¼Œè¯·ä½¿ç”¨ç›®å½•æ¨¡å¼ï¼ˆå³åˆ›å»º `pkgs/<name>/package.nix`ï¼‰ã€‚è¯¥ç›®å½•ä¸‹çš„å…¶ä»– `.nix` æ–‡ä»¶ï¼ˆå¦‚ `helper.nix`ï¼‰ä¸ä¼šè¢«è‡ªåŠ¨æ‰«æä¸ºç‹¬ç«‹åŒ…ï¼Œä»è€Œä¿æŒå¯¹å¤–æ¥å£çš„æ•´æ´ã€‚

### å¼€å‘æµç¨‹

*   **å¿«é€Ÿå¼€å§‹**ï¼šæ€»æ˜¯ä½¿ç”¨æ¨¡æ¿ (`nix flake init --template ...`) æ¥åˆå§‹åŒ–æ–°é¡¹ç›®æˆ–ç»„ä»¶ã€‚
*   **æŒç»­æ£€æŸ¥**ï¼šå…»æˆè¿è¡Œ `nix flake check` çš„ä¹ æƒ¯ï¼Œé…åˆ `checks/` ç›®å½•ä¸‹çš„æµ‹è¯•ç”¨ä¾‹ã€‚
*   **æ ¼å¼åŒ–**ï¼šä½¿ç”¨ `nix fmt` ä¿æŒä»£ç é£æ ¼ç»Ÿä¸€ã€‚

### æ€§èƒ½ä¼˜åŒ–

*   **æ¨¡å—åŒ–ç®¡ç†**ï¼šå¯¹äºæ‹¥æœ‰å¤§é‡ NixOS æ¨¡å—çš„é¡¹ç›®ï¼ŒFlake FHS çš„æ¨¡å—åŠ è½½æœºåˆ¶ï¼ˆGuarded Modulesï¼‰å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°ç»„ç»‡ä»£ç ã€‚ç¡®ä¿å°†ç‹¬ç«‹çš„æ¨¡å—æ”¾å…¥å¸¦æœ‰ `options.nix` çš„å­ç›®å½•ä¸­ï¼Œè¿™æ ·åªæœ‰åœ¨ `enable = true` æ—¶æ‰ä¼šæ¿€æ´»å…¶é…ç½®é€»è¾‘ã€‚
